<clr-wizard #wizard [(clrWizardOpen)]="opened" [clrWizardClosable]="false" (clrWizardOnCancel)="onCancel()">
    <clr-wizard-title>{{'APP_PLAN_ADD'|translate}}</clr-wizard-title>

    <clr-wizard-button [type]="'cancel'">{{'APP_CANCEL'|translate}}</clr-wizard-button>
    <clr-wizard-button [type]="'previous'">{{'APP_BACK'|translate}}</clr-wizard-button>
    <clr-wizard-button [type]="'next'">{{'APP_NEXT'|translate}}</clr-wizard-button>
    <clr-wizard-button [type]="'finish'">{{'APP_FINISH'|translate}}</clr-wizard-button>

    <clr-wizard-page [clrWizardPageNextDisabled]="basicForm.invalid"
                     (clrWizardPageOnCommit)="onBasicFormCommit()">
        <ng-template clrPageTitle>{{'APP_BASIC_INFORMATION'|translate}}</ng-template>
        <form clrForm #basicForm="ngForm">
            <clr-input-container>
                <label>{{'APP_NAME'|translate}}</label>
                <input clrInput size=45 type="text" maxlength="15" [(ngModel)]="item.name"
                       name="name" required>
                <!--                <clr-control-error *ngIf="nameCtrl&&nameCtrl.errors&&nameCtrl.errors.required">此字段为必填项</clr-control-error>-->
                <!--                <clr-control-error *ngIf="nameCtrl&&nameCtrl.errors&&nameCtrl.errors.repeat">名称重复</clr-control-error>-->
                <!--                <clr-control-error *ngIf="nameCtrl&&nameCtrl.errors&&nameCtrl.invalid">{{name_pattern_tip}}</clr-control-error>-->
                <!--                <clr-control-helper>{{name_pattern_tip}}</clr-control-helper>-->
            </clr-input-container>
            <clr-select-container>
                <label>{{'APP_REGION'|translate}}</label>
                <select clrSelect [(ngModel)]="item.regionId" name="provider" (change)="onRegionChange()" required>
                    <option [value]="">{{'APP_DEFAULT_OPTION'|translate}}</option>
                    <option *ngFor="let re of regions" [value]="re.id">{{re.name}}</option>
                </select>
                <clr-control-error>{{'APP_REQUIRED_ERROR'|translate}}</clr-control-error>
            </clr-select-container>
            <clr-select-container>
                <label>{{'APP_PLAN_DEPLOY_TEMPLATE'|translate}}</label>
                <select [(ngModel)]="item.deployTemplate" name="template" (change)="onDeployChange()" required
                        clrSelect>
                    <option value="">{{'APP_DEFAULT_OPTION'|translate}}</option>
                    <option value="SINGLE">{{'APP_PLAN_DEPLOY_TEMPLATE_SINGLE'|translate}}</option>
                    <option value="MULTIPLE">{{'APP_PLAN_DEPLOY_TEMPLATE_MULTIPLE'|translate}}</option>
                </select>
                <clr-control-error>{{'APP_REQUIRED_ERROR'|translate}}</clr-control-error>
            </clr-select-container>
            <!--&lt;!&ndash;            <clr-select-container>&ndash;&gt;-->
            <!--&lt;!&ndash;                <label>项目</label>&ndash;&gt;-->
            <!--&lt;!&ndash;                <select clrSelect [(ngModel)]="item.item_id" name="item" multiple>&ndash;&gt;-->
            <!--&lt;!&ndash;                    <option [value]="" disabled>请选择</option>&ndash;&gt;-->
            <!--&lt;!&ndash;                    <option *ngFor="let item of items" [value]="item.id">{{item.name}}</option>&ndash;&gt;-->
            <!--&lt;!&ndash;                </select>&ndash;&gt;-->
            <!--&lt;!&ndash;                <clr-control-helper>部署计划需要授权到项目才可用（非必填）</clr-control-helper>&ndash;&gt;-->
            <!--&lt;!&ndash;            </clr-select-container>&ndash;&gt;-->
        </form>
    </clr-wizard-page>
    <clr-wizard-page [clrWizardPageNextDisabled]="planForm.invalid" (clrWizardPageCustomButton)="onSubmit()">
        <ng-template clrPageTitle>{{'APP_PLAN_DEPLOY_CONFIG'|translate}}</ng-template>
        <form clrForm #planForm="ngForm">
            <clr-select-container *ngIf="item.deployTemplate === 'SINGLE'">
                <label>{{'APP_ZONE'|translate}}</label>
                <select clrSelect [(ngModel)]="item.zone" name="cloud-region" required>
                    <option [value]="">{{'APP_DEFAULT_OPTION'|translate}}</option>
                    <option *ngFor="let zone of zones" [value]="zone.id">{{zone.name}}</option>
                </select>
                <clr-control-error>{{'APP_REQUIRED_ERROR'|translate}}</clr-control-error>
            </clr-select-container>

            <clr-select-container *ngIf="item.deployTemplate === 'MULTIPLE'">
                <label>{{'APP_ZONE'|translate}}</label>
                <select clrSelect [(ngModel)]="item.zones" name="cloud-region" multiple required>
                    <option [value]="">{{'APP_DEFAULT_OPTION'|translate}}</option>
                    <option *ngFor="let zone of zones" [value]="zone.id">{{zone.name}}</option>
                </select>
                <clr-control-error>{{'APP_REQUIRED_ERROR'|translate}}</clr-control-error>
            </clr-select-container>
            <clr-select-container>
                <label>{{'APP_PLAN_DEPLOY_MASTER'|translate}}</label>
                <select clrSelect [(ngModel)]="item.planVars['masterModel']" name="master" required>
                    <option [value]="">{{'APP_DEFAULT_OPTION'|translate}}</option>
                    <option *ngFor="let model of vmConfigs" [value]="model.name">{{model.name}}</option>
                </select>
                <clr-control-error>{{'APP_REQUIRED_ERROR'|translate}}</clr-control-error>
            </clr-select-container>
            <clr-select-container>
                <label>{{'APP_PLAN_DEPLOY_WORKER'|translate}}</label>
                <select clrSelect [(ngModel)]="item.planVars['workerModel']" name="worker" required>
                    <option [value]="">{{'APP_DEFAULT_OPTION'|translate}}</option>
                    <option *ngFor="let model of vmConfigs" [value]="model.name">{{model.name}}</option>
                </select>
                <clr-control-error>{{'APP_REQUIRED_ERROR'|translate}}</clr-control-error>
            </clr-select-container>
        </form>
        <div *ngIf="vmConfigs">
            <h3>{{'APP_PLAN_DEPLOY_CONFIG_REFERENCE'|translate}}</h3>
            <table class="table">
                <thead>
                <tr>
                    <th>{{'APP_CONFIG'|translate}}</th>
                    <th>{{'APP_CPU'|translate}}</th>
                    <th>{{'APP_HOST_MEMORY_GB'|translate}}</th>
                    <th>{{'APP_HOST_DISK'|translate}}</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let model of vmConfigs">
                    <td>{{model.name}}</td>
                    <td>{{model.config.cpu}}</td>
                    <td>{{model.config.memory}}</td>
                    <td>{{model.config.disk}}</td>
                </tr>
                </tbody>
            </table>
        </div>
        <ng-template clrPageButtons>
            <clr-wizard-button [type]="'cancel'">{{'APP_CANCEL'|translate}}</clr-wizard-button>
            <clr-wizard-button [type]="'previous'">{{'APP_BACK'|translate}}</clr-wizard-button>
            <clr-wizard-button [type]="'custom-finish'">{{'APP_FINISH'|translate}}</clr-wizard-button>
        </ng-template>
    </clr-wizard-page>
</clr-wizard>



